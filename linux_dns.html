<!DOCTYPE html>
    <html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <title>Linux下搭建DNS服务器</title>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        
    </head>
    <body>
        <h1 id="linux%e4%b8%8b%e6%90%ad%e5%bb%badns%e6%9c%8d%e5%8a%a1%e5%99%a8">Linux下搭建DNS服务器</h1>
<h2 id="%e4%b8%80%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c">一、准备工作</h2>
<h3 id="1%e5%b0%86%e8%99%9a%e6%8b%9f%e6%9c%ba%e7%bd%91%e7%bb%9c%e8%ae%be%e7%bd%ae%e4%b8%ba%e6%a1%a5%e6%8e%a5">1.将虚拟机网络设置为桥接</h3>
<h3 id="2%e9%85%8d%e7%bd%ae%e7%bd%91%e5%8d%a1">2.配置网卡</h3>
<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-eth0
</code></pre>
<p>修改如下内容</p>
<pre><code><div>BOOTPROTO=static
IPADDR=192.168.xxx.1
NETMASK=255.255.255.0
</div></code></pre>
<p>重启网络</p>
<pre><code><div>service network restart
</div></code></pre>
<h2 id="%e4%ba%8c%e5%ae%89%e8%a3%85%e8%bd%af%e4%bb%b6%e5%8c%85">二、安装软件包</h2>
<h3 id="1%e8%99%9a%e6%8b%9f%e6%9c%ba%e6%8c%82%e8%bd%bd%e5%85%89%e9%a9%b1%e9%95%9c%e5%83%8f%e6%96%87%e4%bb%b6%e9%80%89%e6%8b%a9rhel-66iso">1.虚拟机挂载光驱，镜像文件选择RHEL 6.6.iso</h3>
<h3 id="2%e5%ae%89%e8%a3%85bind">2.安装bind</h3>
<pre><code>cd /media/RHEL-6.6\ Server.i386/Packages
rpm -ivh bind-9.8.2-0.30.rc1.el6.i686.rpm
</code></pre>
<h2 id="%e4%b8%89%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6">三、修改配置文件</h2>
<h3 id="1%e4%bf%ae%e6%94%b9dns%e4%b8%bb%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6">1.修改DNS主配置文件</h3>
<pre><code>vim /etc/named.conf
</code></pre>
<p>修改如下内容</p>
<pre><code><div>listen on port 53 { any; }
allow-query { any; }
</div></code></pre>
<h3 id="2%e4%bf%ae%e6%94%b9namedrfc1912zones%e6%96%87%e4%bb%b6">2.修改named.rfc1912.zones文件</h3>
<pre><code>vim /etc/named.rfc1912.zones
</code></pre>
<p>编辑如下</p>
<p><img src="https://i.loli.net/2019/08/14/4OgEC5IKfFhuRJY.png" alt="named.rfc1912.zones">)</p>
<h3 id="3%e5%a2%9e%e5%8a%a0%e5%b9%b6%e4%bf%ae%e6%94%b9%e6%ad%a3%e5%90%91%e8%a7%a3%e6%9e%90%e6%96%87%e4%bb%b6%e5%92%8c%e5%8f%8d%e5%90%91%e8%a7%a3%e6%9e%90%e6%96%87%e4%bb%b6">3.增加并修改正向解析文件和反向解析文件</h3>
<p>修改zone配置文件正向解析</p>
<pre><code><div>cd /var/named
cp -p named.localhost xxx.com.zone
vim xxx.com.zone
</div></code></pre>
<p>编辑如下</p>
<p><img src="https://i.loli.net/2019/08/14/ZDBEWTpCF51JmOP.jpg" alt="xxx.com.zone"></p>
<p>修改zone配置文件反向解析</p>
<pre><code><div>cp -p named.localhost 192.168.xxx.zone
vim 192.168.xxx
</div></code></pre>
<p>编辑如下</p>
<p><img src="https://i.loli.net/2019/08/14/7dwKzhXgvJWq51L.jpg" alt="192.168.xxx"></p>
<h2 id="%e5%9b%9b%e5%ae%89%e5%85%a8%e7%ad%96%e7%95%a5">四、安全策略</h2>
<h3 id="1%e6%9b%b4%e6%94%b9selinux%e8%ae%be%e7%bd%ae">1.更改selinux设置</h3>
<pre><code>setenforce 0
</code></pre>
<h3 id="2%e5%85%b3%e9%97%ad%e9%98%b2%e7%81%ab%e5%a2%99">2.关闭防火墙</h3>
<pre><code>service iptables stop
</code></pre>
<p>或者使用<code>setup</code>命令,选择<code>Firewall configuration</code>下的<code>Security Level</code>并设置为<code>Disabled</code>，然后保存退出</p>
<h2 id="%e4%ba%94%e8%b0%83%e8%af%95%e6%a3%80%e6%9f%a5">五、调试检查</h2>
<h3 id="1%e9%87%8d%e5%90%afdns%e5%92%8c%e7%bd%91%e7%bb%9c%e6%9c%8d%e5%8a%a1">1.重启DNS和网络服务</h3>
<pre><code>service network restart
service named restart
</code></pre>
<h3 id="2%e6%b5%8b%e8%af%95dns">2.测试DNS</h3>
<pre><code>nslookup
</code></pre>

    </body>
    </html>